import{a as z}from"./chunk-YBP35VN7.js";import{c as T}from"./chunk-RAPWA5KR.js";import{i as k,j as I,l as E,m as R}from"./chunk-BU23HKAK.js";import{Ba as r,Cb as O,Db as S,Ga as P,Na as b,Sa as g,aa as u,ba as x,db as l,eb as i,fb as n,gb as m,hb as v,kb as f,lb as c,rb as C,sb as y,tb as M,ub as s,vb as p,wb as _,xb as w}from"./chunk-FTSNUNWW.js";function F(o,t){if(o&1&&(i(0,"p",16),s(1," Managing permissions for: "),i(2,"strong"),s(3),n()()),o&2){let e=c();r(3),p(e.selectedRole.nom)}}function j(o,t){if(o&1&&(i(0,"div",17)(1,"span",18),s(2),n(),i(3,"small",19),s(4,"Selected"),n()()),o&2){let e=c();r(2),w("",e.getSelectedCount()," / ",e.getTotalCount())}}function N(o,t){o&1&&(i(0,"div",20)(1,"div",21)(2,"span",22),s(3,"Loading..."),n()(),i(4,"p",23),s(5,"Loading permissions..."),n()())}function B(o,t){if(o&1){let e=v();i(0,"div",24),m(1,"i",25),s(2),i(3,"button",26),f("click",function(){u(e);let d=c();return x(d.successMessage=null)}),n()()}if(o&2){let e=c();r(2),_(" ",e.successMessage," ")}}function D(o,t){if(o&1){let e=v();i(0,"div",27),m(1,"i",28),s(2),i(3,"button",26),f("click",function(){u(e);let d=c();return x(d.error=null)}),n()()}if(o&2){let e=c();r(2),_(" ",e.error," ")}}function L(o,t){if(o&1){let e=v();i(0,"div",63)(1,"div",64)(2,"div",65),m(3,"i"),n(),i(4,"div",66)(5,"h6",67),s(6),n(),i(7,"p",68),s(8),n()(),i(9,"div",69)(10,"div",70)(11,"input",71),f("change",function(){let d=u(e).$implicit,V=c(3);return x(V.togglePermission(d.id))}),n(),i(12,"label",72)(13,"span",22),s(14),n()()()()()()}if(o&2){let e=t.$implicit,a=c(3);r(),y("active",a.isPermissionSelected(e.id)),r(2),M(a.getPermissionIcon(e.nom)),r(3),p(e.nom),r(2),p(e.description||"No description available"),r(3),l("id","permission-"+e.id)("checked",a.isPermissionSelected(e.id)),r(),l("for","permission-"+e.id),r(2),_("Toggle ",e.nom)}}function q(o,t){if(o&1&&(i(0,"div",57)(1,"div",58)(2,"h5",59),s(3),n(),i(4,"span",60),s(5),n()(),i(6,"div",61),g(7,L,15,10,"div",62),n()()),o&2){let e=t.$implicit;r(3),p(e.key),r(2),_("",e.value.length," permissions"),r(2),l("ngForOf",e.value)}}function G(o,t){o&1&&m(0,"span",73)}function U(o,t){o&1&&m(0,"i",74)}function Y(o,t){if(o&1){let e=v();i(0,"div",29)(1,"div",30)(2,"div",31),g(3,q,8,3,"div",32),O(4,"keyvalue"),n()(),i(5,"div",33)(6,"div",34)(7,"div",35)(8,"div",36)(9,"div",37),m(10,"i",38),n(),i(11,"div")(12,"h6",39),s(13),n(),i(14,"p",40),s(15),n()()()(),i(16,"div",41)(17,"h6",42),s(18,"Permission Summary"),n(),i(19,"div",43)(20,"div",44)(21,"span",45),s(22,"Total Permissions:"),n(),i(23,"span",46),s(24),n()(),i(25,"div",44)(26,"span",45),s(27,"Selected:"),n(),i(28,"span",47),s(29),n()(),i(30,"div",44)(31,"span",45),s(32,"Unselected:"),n(),i(33,"span",48),s(34),n()()(),i(35,"div",49),m(36,"div",50),n()(),i(37,"div",51)(38,"button",52),f("click",function(){u(e);let d=c();return x(d.savePermissions())}),g(39,G,1,0,"span",53)(40,U,1,0,"i",54),s(41),n(),i(42,"button",55),f("click",function(){u(e);let d=c();return x(d.goBackToRoles())}),m(43,"i",56),s(44," Cancel "),n()()()()()}if(o&2){let e=c();r(3),l("ngForOf",S(4,12,e.getGroupedPermissions())),r(10),p(e.selectedRole.nom),r(2),p(e.selectedRole.description),r(9),p(e.getTotalCount()),r(5),p(e.getSelectedCount()),r(5),p(e.getTotalCount()-e.getSelectedCount()),r(2),C("width",e.getSelectedCount()/e.getTotalCount()*100,"%"),r(2),l("disabled",e.saving),r(),l("ngIf",e.saving),r(),l("ngIf",!e.saving),r(),_(" ",e.saving?"Saving...":"Save Permissions"," ")}}var h=class o{constructor(t,e){this.rolePermissionService=t;this.router=e}selectedRole=null;allPermissions=[];rolePermissions=[];selectedPermissionIds=new Set;loading=!1;saving=!1;error=null;successMessage=null;ngOnInit(){this.loadSelectedRole(),this.selectedRole&&this.loadPermissions()}loadSelectedRole(){let t=localStorage.getItem("selectedRole");t?this.selectedRole=JSON.parse(t):this.router.navigate(["/roles"])}loadPermissions(){this.selectedRole&&(this.loading=!0,this.error=null,Promise.all([this.rolePermissionService.getPermissions().toPromise(),this.rolePermissionService.getRolePermissions(this.selectedRole.id).toPromise()]).then(([t,e])=>{this.allPermissions=t||[],this.rolePermissions=e||[],this.selectedPermissionIds.clear(),this.rolePermissions.forEach(a=>{this.selectedPermissionIds.add(a.id)}),this.loading=!1}).catch(t=>{this.error="Failed to load permissions. Please try again.",this.loading=!1,console.error("Error loading permissions:",t)}))}togglePermission(t){this.selectedPermissionIds.has(t)?this.selectedPermissionIds.delete(t):this.selectedPermissionIds.add(t)}isPermissionSelected(t){return this.selectedPermissionIds.has(t)}savePermissions(){if(!this.selectedRole)return;this.saving=!0,this.error=null,this.successMessage=null;let t={permissionIds:Array.from(this.selectedPermissionIds)};this.rolePermissionService.updateRolePermissions(this.selectedRole.id,t).subscribe({next:()=>{this.saving=!1,this.successMessage="Permissions updated successfully!",setTimeout(()=>{this.successMessage=null},3e3)},error:e=>{this.saving=!1,this.error="Failed to save permissions. Please try again.",console.error("Error saving permissions:",e)}})}goBackToRoles(){localStorage.removeItem("selectedRole"),this.router.navigate(["/roles"])}getPermissionIcon(t){let e=t.toLowerCase();return e.includes("read")||e.includes("view")?"fas fa-eye":e.includes("write")||e.includes("create")?"fas fa-plus":e.includes("update")||e.includes("edit")?"fas fa-edit":e.includes("delete")?"fas fa-trash":e.includes("admin")?"fas fa-crown":e.includes("manage")?"fas fa-cogs":"fas fa-key"}getPermissionCategory(t){let e=t.toLowerCase();return e.includes("user")?"User Management":e.includes("role")?"Role Management":e.includes("system")?"System":e.includes("report")?"Reports":e.includes("setting")?"Settings":"General"}getGroupedPermissions(){let t={};return this.allPermissions.forEach(e=>{let a=this.getPermissionCategory(e.nom);t[a]||(t[a]=[]),t[a].push(e)}),t}getSelectedCount(){return this.selectedPermissionIds.size}getTotalCount(){return this.allPermissions.length}static \u0275fac=function(e){return new(e||o)(P(z),P(T))};static \u0275cmp=b({type:o,selectors:[["app-permission"]],decls:17,vars:6,consts:[[1,"container-fluid","py-4"],[1,"row","mb-4"],[1,"col-12"],[1,"permission-header"],[1,"d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center"],[1,"btn","btn-back","me-3",3,"click"],[1,"fas","fa-arrow-left"],[1,"header-content"],[1,"header-title","mb-1"],["class","header-subtitle mb-0",4,"ngIf"],["class","permission-counter",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","alert alert-success alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","row",4,"ngIf"],[1,"header-subtitle","mb-0"],[1,"permission-counter"],[1,"counter-text"],[1,"text-muted","d-block"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3","text-muted"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],[1,"fas","fa-check-circle","me-2"],["type","button",1,"btn-close",3,"click"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"row"],[1,"col-lg-8"],[1,"permissions-container"],["class","permission-category",4,"ngFor","ngForOf"],[1,"col-lg-4"],[1,"sidebar-sticky"],[1,"role-info-card"],[1,"role-info-header"],[1,"role-avatar"],[1,"fas","fa-user-shield"],[1,"role-name"],[1,"role-desc"],[1,"summary-card"],[1,"summary-title"],[1,"summary-stats"],[1,"stat-row"],[1,"stat-label"],[1,"stat-value"],[1,"stat-value","text-success"],[1,"stat-value","text-muted"],[1,"progress","mt-3"],["role","progressbar",1,"progress-bar"],[1,"action-buttons"],[1,"btn","btn-save",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-save me-2",4,"ngIf"],[1,"btn","btn-cancel",3,"click"],[1,"fas","fa-times","me-2"],[1,"permission-category"],[1,"category-header"],[1,"category-title"],[1,"category-count"],[1,"permission-grid"],["class","permission-item",4,"ngFor","ngForOf"],[1,"permission-item"],[1,"permission-card"],[1,"permission-icon"],[1,"permission-info"],[1,"permission-name"],[1,"permission-description"],[1,"permission-toggle"],[1,"form-check","form-switch"],["type","checkbox",1,"form-check-input","permission-switch",3,"change","id","checked"],[1,"form-check-label",3,"for"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),f("click",function(){return a.goBackToRoles()}),m(7,"i",7),n(),i(8,"div",8)(9,"h1",9),s(10,"Permission Management"),n(),g(11,F,4,1,"p",10),n()(),g(12,j,5,2,"div",11),n()()()(),g(13,N,6,0,"div",12)(14,B,4,1,"div",13)(15,D,4,1,"div",14)(16,Y,45,14,"div",15),n()),e&2&&(r(11),l("ngIf",a.selectedRole),r(),l("ngIf",!a.loading),r(),l("ngIf",a.loading),r(),l("ngIf",a.successMessage),r(),l("ngIf",a.error),r(),l("ngIf",!a.loading&&a.selectedRole))},dependencies:[R,k,I,E],styles:[".permission-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);border-radius:20px;padding:2rem;color:#fff;box-shadow:0 10px 30px #28a7454d}.btn-back[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;width:45px;height:45px;border-radius:12px;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.btn-back[_ngcontent-%COMP%]:hover{background:#ffffff4d;color:#fff;transform:translate(-2px)}.header-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0}.header-subtitle[_ngcontent-%COMP%]{opacity:.9;font-size:1.1rem}.permission-counter[_ngcontent-%COMP%]{text-align:center;background:#fff3;padding:1rem;border-radius:12px;min-width:100px}.counter-text[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;display:block}.permissions-container[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:2rem;box-shadow:0 5px 20px #00000014}.permission-category[_ngcontent-%COMP%]{margin-bottom:2rem}.category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:2px solid #f8f9fa}.category-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#2c3e50;margin:0}.category-count[_ngcontent-%COMP%]{background:#e9ecef;color:#6c757d;padding:.25rem .75rem;border-radius:20px;font-size:.8rem;font-weight:500}.permission-grid[_ngcontent-%COMP%]{display:grid;gap:1rem}.permission-item[_ngcontent-%COMP%]{transition:all .3s ease}.permission-card[_ngcontent-%COMP%]{background:#f8f9fa;border:2px solid transparent;border-radius:15px;padding:1.5rem;display:flex;align-items:center;gap:1rem;transition:all .3s ease;cursor:pointer}.permission-card[_ngcontent-%COMP%]:hover{background:#e9ecef;transform:translateY(-2px);box-shadow:0 5px 15px #0000001a}.permission-card.active[_ngcontent-%COMP%]{background:#d4edda;border-color:#28a745;box-shadow:0 5px 15px #28a74533}.permission-icon[_ngcontent-%COMP%]{width:45px;height:45px;background:linear-gradient(135deg,#007bff,#0056b3);border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.1rem;flex-shrink:0}.permission-card.active[_ngcontent-%COMP%]   .permission-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997)}.permission-info[_ngcontent-%COMP%]{flex-grow:1;min-width:0}.permission-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#2c3e50;margin-bottom:.25rem}.permission-description[_ngcontent-%COMP%]{color:#6c757d;font-size:.85rem;margin:0;line-height:1.4}.permission-toggle[_ngcontent-%COMP%]{flex-shrink:0}.permission-switch[_ngcontent-%COMP%]{width:3rem!important;height:1.5rem!important;cursor:pointer}.permission-switch[_ngcontent-%COMP%]:checked{background-color:#28a745;border-color:#28a745}.permission-switch[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .25rem #28a74540}.sidebar-sticky[_ngcontent-%COMP%]{position:sticky;top:2rem;display:flex;flex-direction:column;gap:1.5rem}.role-info-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:1.5rem;box-shadow:0 5px 20px #00000014}.role-info-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.role-avatar[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(135deg,#6f42c1,#e83e8c);border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.2rem}.role-name[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#2c3e50;margin-bottom:.25rem}.role-desc[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem;margin:0}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:1.5rem;box-shadow:0 5px 20px #00000014}.summary-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#2c3e50;margin-bottom:1rem}.summary-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.stat-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.stat-label[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem}.stat-value[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem}.progress[_ngcontent-%COMP%]{height:8px;border-radius:10px;background-color:#e9ecef}.progress-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#28a745,#20c997);border-radius:10px;transition:width .3s ease}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.btn-save[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);border:none;color:#fff;padding:.75rem 1.5rem;border-radius:12px;font-weight:500;transition:all .3s ease}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1ea085);transform:translateY(-2px);box-shadow:0 5px 15px #28a7454d;color:#fff}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.btn-cancel[_ngcontent-%COMP%]{background:#6c757d;border:none;color:#fff;padding:.75rem 1.5rem;border-radius:12px;font-weight:500;transition:all .3s ease}.btn-cancel[_ngcontent-%COMP%]:hover{background:#5a6268;color:#fff;transform:translateY(-2px)}@media (max-width: 992px){.sidebar-sticky[_ngcontent-%COMP%]{position:static;margin-top:2rem}.permission-header[_ngcontent-%COMP%]{padding:1.5rem}.header-title[_ngcontent-%COMP%]{font-size:1.5rem}.permissions-container[_ngcontent-%COMP%]{padding:1.5rem}}@media (max-width: 768px){.permission-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:1rem}.permission-info[_ngcontent-%COMP%]{order:1}.permission-toggle[_ngcontent-%COMP%]{order:2}.permission-icon[_ngcontent-%COMP%]{order:0;margin:0 auto}}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}.alert[_ngcontent-%COMP%]{border-radius:12px;border:none}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}"]})};var Z=[{path:"",component:h}];export{Z as Permission_ROUTES};
